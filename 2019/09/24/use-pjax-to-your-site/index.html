<!DOCTYPE html><html lang="zh-CN"><head><link rel="manifest" href="/manifest.json"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="keywords" content="liuyib, Liuyib's Blog"><meta name="description" content="åšå®¢ï¼Œåˆ†äº«ï¼Œå¼€æºï¼Œå¿ƒå¾—"><title>é›†æˆ Pjax å®ç°ç½‘ç«™æ— åˆ·æ–°åŠ è½½</title><meta name="google-site-verification" content="_dxRdKposlAngL4xRoCTrJu0sZ7Pp_RhlBF9inxcD5w"><meta name="msvalidate.01" content="6A508F795A82FADAC671AFCB9848929F"><meta name="baidu-site-verification" content="UYjZUCoORR"><meta name="360-site-verification" content="b926bfcb0e6034f32ac4700700a812f5"><meta name="theme-color" content="#54bcff"><link rel="manifest" href="/manifest.json?v=1.5.4"><link rel="icon" href="/images/icons/favicon-16x16.png?v=1.5.4" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=1.5.4" type="image/png" sizes="32x32"><link rel="alternate" href="/atom.xml" type="application/atom+xml"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=1.5.4"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="dns-prefetch" href="https://hm.baidu.com"><link rel="dns-prefetch" href="https://tajs.qq.com"><script src="https://www.googletagmanager.com/gtag/js?id=UA-146413033-1" async data-pjax=""></script><script data-pjax="">if("localhost"!==window.location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-146413033-1")}</script><script>var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?2be584e2ddc153d81489b57ba106c8c0",t.async=!0,t.setAttribute("data-pjax","");var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>!function(){var t=document.createElement("script");t.src="https://tajs.qq.com/stats?sId=66465986",t.async=!0,t.setAttribute("data-pjax","");var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>var Stun=window.Stun||{},CONFIG={root:"/",algolia:void 0,fontawesome:{prefix:"fa"},sidebar:{offsetTop:"30px",tocMaxDepth:4},header:{scrollDownIcon:!0},night_mode:{enable:!0},back2top:{enable:!0},reward:!0,fancybox:!1,zoom_image:{enable:!0,mask_color:"rgba(0,0,0,0.6)"},gallery_waterfall:{enable:!0,col_width:"220px",gap_x:"10px",gap_y:"10px"},lazyload:{enable:!0,placeholder:"gif"},pjax:{scrollTo2screen:!0},external_link:{icon:{enable:!0,name:"external-link"}},shortcuts:{switch_post:!0},prompt:{copy_success:"å¤åˆ¶æˆåŠŸ",copy_error:"å¤åˆ¶å¤±è´¥",creative_commons:"çŸ¥è¯†å…±äº«",copy_button:"ç‚¹å‡»å¤åˆ¶"}};window.CONFIG=CONFIG</script></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav"><div class="header-nav-inner"><div class="header-nav-btn fa fa-bars"></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/"><i class="fa fa-home"></i>é¦–é¡µ</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a nopointer" href="javascript:;"><i class="fa fa-paint-brush"></i>æ–‡ç« </a><div class="header-nav-submenu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/archives/"><i class="fa fa-folder-open"></i>å½’æ¡£</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/categories/"><i class="fa fa-th"></i>åˆ†ç±»</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/tags/"><i class="fa fa-tags"></i>æ ‡ç­¾</a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a nopointer" href="javascript:;"><i class="fa fa-flask"></i>å®éªŒå®¤</a><div class="header-nav-submenu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="https://github.com/liuyib/hexo-theme-stun" target="_blank" rel="noopener">ğŸ¦„ Stun</a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/about/"><i class="fa fa-user"></i>å…³äº</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/gallery/"><i class="fa fa-picture-o"></i>ç›¸å†Œ</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/friends/"><i class="fa fa-hand-spock-o"></i>å‹é“¾</a></div></div><div class="header-nav-search"><i class="fa fa-search"></i><span>æœç´¢</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-info"><div class="header-info-inner"><div class="header-info-title">Liuyib's Blog</div><div class="header-info-subtitle">write code and love life</div></div><div class="header-info-scrolldown"><i class="fa fa-angle-down header-info-scrolldown__icon"></i></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content"><div class="post"><header class="post-header"><h1 class="post-header-title">é›†æˆ Pjax å®ç°ç½‘ç«™æ— åˆ·æ–°åŠ è½½</h1><div class="post-header-meta"><span class="post-header-meta-create"><i class="fa fa-calendar-o"></i><span>å‘è¡¨äº </span><span>2019-09-24</span></span><span class="post-header-meta-update"><i class="fa fa-calendar-check-o"></i><span>æ›´æ–°äº </span><span>2019-11-16</span></span><span class="post-header-meta-word-count"><i class="fa fa-file-word-o"></i><span>å­—æ•°ç»Ÿè®¡ </span><span>2.1k</span></span><span class="post-header-meta-reading-time"><i class="fa fa-clock-o"></i><span>é˜…è¯»æ—¶é•¿ </span><span>14m</span></span><span class="post-header-meta-reading-count"><i class="fa fa-eye"></i><span>é˜…è¯»æ¬¡æ•° </span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><h2 id="å‰è¨€"><span class="heading-link">å‰è¨€</span></h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªç½‘é¡µé“¾æ¥åï¼Œæµè§ˆå™¨å°±ä¼šåŠªåŠ›å‘é€ç½‘ç»œè¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚åˆ°çš„ç½‘é¡µæ¸²æŸ“å‡ºæ¥ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªç½‘ç«™ä¸­ä¸åœåœ°ç‚¹å‡»é“¾æ¥ï¼Œç„¶åç½‘é¡µä¸åœåœ°è·³è½¬ã€‚é€šå¸¸ï¼Œæµè§ˆå™¨ä¼šå¯¹æ–‡ä»¶èµ„æºè¿›è¡Œä¸€å®šçš„ç¼“å­˜ï¼Œè¿™æ ·ä½¿å¾—åŒä¸€ä¸ªç½‘ç«™ä¹‹é—´çš„é¡µé¢è·³è½¬æ—¶ï¼Œèƒ½å¤Ÿæ›´å¿«çš„åŠ è½½ã€‚</p><p>è™½ç„¶æµè§ˆå™¨å¯¹èµ„æºçš„ç¼“å­˜åŠ å¿«äº†é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä½†æ˜¯é¡µé¢æ¯ä¸€æ¬¡è·³è½¬æ—¶ï¼Œéƒ½ä¼šæ•´ä½“åˆ·æ–°ä¸€æ¬¡ï¼Œè¿™ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç”¨æˆ·ä½“éªŒã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Pjax å®ç°ç½‘ç«™æ— åˆ·æ–°åŠ è½½ã€‚</p><a id="more"></a><h2 id="pjax-åŸç†"><span class="heading-link">Pjax åŸç†</span></h2><p>é¦–å…ˆè¦çŸ¥é“ <code>Pjax = Ajax + pushState</code>ã€‚å½“ç”¨æˆ·è¿›è¡Œè¶…é“¾è¯·æ±‚æ—¶ï¼ŒPjax ä¼šæ‹¦æˆªè¯·æ±‚ï¼Œç„¶åè§¦å‘ Ajax è¯·æ±‚å’Œ <code>pushState</code>ã€‚å…¶ä¸­ï¼ŒAjax ä½¿ä½ çš„é¡µé¢å±€éƒ¨åˆ·æ–°ï¼Œ<code>pushState</code> ç”¨äºä¿®æ”¹ URL è€Œä¸è·³è½¬é¡µé¢ï¼Œä»è€Œå®ç°ä¸è·³è½¬é¡µé¢å±€éƒ¨åˆ·æ–°çš„åŠŸèƒ½ã€‚</p><h2 id="å¼€å§‹ä½¿ç”¨"><span class="heading-link">å¼€å§‹ä½¿ç”¨</span></h2><p>Pjax æœ‰ä¾èµ–å’Œä¸ä¾èµ– jQuery çš„ä¸¤ç§ç‰ˆæœ¬ï¼š</p><ul><li><span class="external-link"><a href="https://github.com/defunkt/jquery-pjax" target="_blank" rel="noopener">defunkt/jquery-pjax</a><i class="fa fa-external-link"></i></span>ã€ä¾èµ–äº jQueryã€‘</li><li><span class="external-link"><a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">MoOx/pjax</a><i class="fa fa-external-link"></i></span>ã€æ¨èã€‘</li></ul><p>è¿™é‡Œä»¥ä¸ä¾èµ– jQuery çš„ <span class="external-link"><a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">MoOx/pjax</a><i class="fa fa-external-link"></i></span> ä½œä¸ºæ•™ç¨‹ã€‚</p><h3 id="å¼•ç”¨æ–‡ä»¶"><span class="heading-link">å¼•ç”¨æ–‡ä»¶</span></h3><p>ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨ JSDelivr å…¬å…±çš„ CDN åœ°å€ï¼š</p><figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/pjax/pjax.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></div></figure><h3 id="åˆ†æé¡µé¢"><span class="heading-link">åˆ†æé¡µé¢</span></h3><p>åœ¨ç½‘ç«™é¡µé¢åˆ‡æ¢æ—¶ï¼Œæœ‰äº›éƒ¨åˆ†æ˜¯ä¸å˜çš„ï¼Œæœ‰äº›æ˜¯æ”¹å˜çš„ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®ç½‘ç«™çš„ DOM ç»“æ„è‡ªè¡Œåˆ†æã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾é¡µé¢çš„ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Liuyib's Blog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"liuyib, Liuyib's Blog"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span> <span class="attr">id</span>=<span class="string">"header"</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line">    é¡¶éƒ¨æ ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span> <span class="attr">id</span>=<span class="string">"main"</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">    ä¸»ä½“éƒ¨åˆ†...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">    åº•éƒ¨æ ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></div></figure><p>æ¯æ¬¡åˆ‡æ¢é¡µé¢æ—¶ï¼Œ<code>title</code> ä¼šéšä¹‹æ”¹å˜ï¼Œ<code>header</code> å’Œ <code>footer</code> ä¸€èˆ¬ä¸å˜ï¼Œè€Œ <code>main</code> æ˜¯ç½‘ç«™çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¹Ÿä¼šæ”¹å˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥ä½¿ç”¨ Pjaxï¼š</p><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pjax = <span class="keyword">new</span> Pjax(&#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå¡«å†™é¡µé¢ä¸å˜çš„éƒ¨åˆ†ï¼ˆå’Œ CSS é€‰æ‹©å™¨ç”¨æ³•ä¸€æ ·ï¼‰</span></span><br><span class="line">  selectors: [</span><br><span class="line">    <span class="string">"head title"</span>,</span><br><span class="line">    <span class="string">"#main"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure><p>è¿™æ ·ï¼Œå°±å®ç°äº†ä¸€ä¸ªæœ€ç®€å•çš„ Pjax ç½‘ç«™ï¼Œä¸è¿‡è¿™æ‰åˆšå¼€å§‹ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å‚æ•°ï¼š</p><ul><li><p><code>elements</code>ï¼šé»˜è®¤å€¼ <code>a[href], form[action]</code></p><p>æŒ‡å®šåº”ç”¨ Pjax çš„é“¾æ¥ã€‚</p></li><li><p><code>switches</code>ï¼šé»˜è®¤å€¼ <code>{}</code></p><p>ä½¿ç”¨æ—§å…ƒç´ æ›¿æ¢æ–°å…ƒç´ ã€‚</p></li><li><p><code>history</code>ï¼šé»˜è®¤å€¼ <code>true</code></p><p>æ˜¯å¦å¯ç”¨ <code>pushState</code>ã€‚ç¦ç”¨å Pjax å°±å˜æˆäº† Ajaxã€‚</p></li><li><p><code>scrollTo</code>ï¼šé»˜è®¤å€¼ <code>0</code></p><p>é¡µé¢åˆ‡æ¢ååˆ°é¡¶éƒ¨çš„è·ç¦»ã€‚è®¾ä¸º <code>false</code> è¡¨ç¤ºé¡µé¢ä¿æŒåœ¨åˆ‡æ¢å‰çš„ä½ç½®ã€‚</p></li><li><p><code>scrollRestoration</code>ï¼šé»˜è®¤å€¼ <code>true</code></p><p>åˆ‡æ¢é¡µé¢åï¼ŒPjax å°†å°è¯•æ¢å¤æ»šåŠ¨ä½ç½®ã€‚</p></li><li><p><code>cacheBust</code>ï¼šé»˜è®¤å€¼ <code>true</code></p><p>æ˜¯å¦åœ¨ URL ä¸Šæ·»åŠ æ—¶é—´æˆ³ï¼Œé˜²æ­¢æµè§ˆå™¨ç¼“å­˜ã€‚</p></li></ul><p>å…³äºè¿™äº›å‚æ•°çš„ä½œç”¨å’Œè®¾ç½®ï¼Œæ ¹æ®éœ€è¦è‡ªè¡Œé€‰æ‹©ã€‚æ›´å¤šå‚æ•°ï¼Œè¯·æŸ¥çœ‹ MoOx/pjax é¡¹ç›®çš„ <span class="external-link"><a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">READMD</a><i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="æ·»åŠ è¿›åº¦æ¡"><span class="heading-link">æ·»åŠ è¿›åº¦æ¡</span></h3><p>ä½¿ç”¨äº† Pjax åï¼Œåœ¨è¿›è¡Œé¡µé¢è·³è½¬æ—¶ï¼Œæµè§ˆå™¨æ²¡æœ‰ä»»ä½•åŠ è½½æç¤ºï¼Œå¹¶ä¸”åœ¨è·³è½¬å®Œæˆä¹‹å‰ï¼Œé¡µé¢ä¸ä¼šæœ‰ä»»ä½•å˜åŒ–ï¼Œå› æ­¤åœ¨ç½‘é€Ÿæ¯”è¾ƒæ…¢çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä»¥ä¸ºé¡µé¢å¹¶æ²¡æœ‰è¿›è¡Œè·³è½¬ã€‚ä¸ºäº†æ”¹å–„ä½“éªŒï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªè¿›åº¦æ¡ï¼Œä»¥æ­¤æ¥å‘Šè¯‰ç”¨æˆ·â€œé¡µé¢æ­£åœ¨åŠ è½½â€ã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œå°±ä¸å¾—ä¸æåˆ° Github çš„åŠ è½½è¿›åº¦æ¡ã€‚å¦‚æœå¿ƒç»†çš„åŒå­¦å¯èƒ½ä¼šå‘ç°ï¼ŒGithub ä¹Ÿä½¿ç”¨äº† Pjaxã€‚é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬ä»¿ç…§ Github æ¥å®ç°ä¸€ä¸ª Pjax åŠ è½½è¿›åº¦æ¡å§ã€‚</p><p>é¦–å…ˆè¦æ¸…æ¥šä¸€ç‚¹ï¼Œè¿™é‡Œè¦å®ç°çš„åŠ è½½è¿›åº¦æ¡å®é™…ä¸Šæ˜¯<strong>å‡çš„</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé¡µé¢å®é™…åŠ è½½äº†å¤šå°‘æˆ‘ä»¬å¹¶æ²¡æœ‰åŠæ³•çŸ¥é“ï¼Œè¿›åº¦æ¡ä¹Ÿåªæ˜¯æŒ‰ç…§ä¸€å®šçš„é€Ÿåº¦å¢åŠ çš„ã€‚</p><blockquote><p>å¦‚æœå¯ä»¥æ§åˆ¶æœåŠ¡ç«¯çš„è¯ï¼Œå¯ä»¥åšå‡º<strong>çœŸçš„</strong>åŠ è½½è¿›åº¦æ¡ï¼Œè‡³å°‘åœ¨ Github Pages ä¸Šè¿˜æš‚æ—¶åšä¸åˆ°ã€‚</p></blockquote><p>HTML(Pug):</p><figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">div.loading-bar</span><br><span class="line">  div.progress</span><br></pre></td></tr></table></div></figure><p>CSS(Stylus):</p><figure class="highlight stylus"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.loading-bar</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">99999</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  transition: opacity .4s linear;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.progress</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#77b6ff</span>;</span><br><span class="line">    box-shadow: 0 0 10px rgba(119, 182, 255, .7);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.loading</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">transition</span>: none;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.progress</span> &#123;</span><br><span class="line">      transition: width .4s ease;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>JavaScript:</p><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loadingBar = <span class="built_in">document</span>.querySelector(<span class="string">'.loading-bar'</span>);</span><br><span class="line"><span class="keyword">var</span> progress = <span class="built_in">document</span>.querySelector(<span class="string">'.loading-bar .progress'</span>);</span><br><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pjax å¼€å§‹æ—¶æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'pjax:send'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// è¿›åº¦æ¡é»˜è®¤å·²ç»åŠ è½½ 20%</span></span><br><span class="line">  <span class="keyword">var</span> loadingBarWidth = <span class="number">20</span>;</span><br><span class="line">  <span class="comment">// è¿›åº¦æ¡çš„æœ€å¤§å¢åŠ å®½åº¦</span></span><br><span class="line">  <span class="keyword">var</span> MAX_LOADING_WIDTH = <span class="number">95</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºè¿›åº¦æ¡</span></span><br><span class="line">  loadingBar.classList.add(<span class="string">'loading'</span>);</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–è¿›åº¦æ¡çš„å®½åº¦</span></span><br><span class="line">  progress.style.width = loadingBarWidth + <span class="string">'%'</span>;</span><br><span class="line"></span><br><span class="line">  clearInterval(timer);</span><br><span class="line">  timer = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è¿›åº¦æ¡çš„å¢åŠ é€Ÿåº¦ï¼ˆå¯ä»¥æ”¹ä¸ºä¸€ä¸ªéšæœºå€¼ï¼Œæ˜¾å¾—æ›´åŠ çœŸå®ï¼‰</span></span><br><span class="line">    loadingBarWidth += <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“è¿›åº¦æ¡åˆ°è¾¾ 95% ååœæ­¢å¢åŠ </span></span><br><span class="line">    <span class="keyword">if</span> (loadingBarWidth &gt; MAX_LOADING_WIDTH) &#123;</span><br><span class="line">      loadingBarWidth = MAX_LOADING_WIDTH;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    progress.style.width = loadingBarWidth + <span class="string">'%'</span>;</span><br><span class="line">  &#125;, <span class="number">500</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pjax å®Œæˆä¹‹åæ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'pjax:complete'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  clearInterval(timer);</span><br><span class="line">  progress.style.width = <span class="string">'100%'</span>;</span><br><span class="line">  loadingBar.classList.remove(<span class="string">'loading'</span>);</span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    progress.style.width = <span class="number">0</span>;</span><br><span class="line">  &#125;, <span class="number">400</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢çš„ä»£ç åŸºæœ¬ä¸Šå®ç°äº† Github ä¸­ Pjax åŠ è½½è¿›åº¦æ¡çš„æ•ˆæœï¼Œä»…ä¾›å‚è€ƒã€‚å…·ä½“æ•ˆæœå¯ä»¥åœ¨æˆ‘çš„<a href="https://liuyib.github.io/">ä¸ªäººåšå®¢</a>ä¸Šä½“éªŒä¸€ä¸‹ã€‚</p><h3 id="é‡è½½-js-è„šæœ¬"><span class="heading-link">é‡è½½ JS è„šæœ¬</span></h3><p><strong>è¿™é‡Œçš„é‡è½½æŒ‡çš„æ˜¯é‡æ–°åŠ è½½</strong>ã€‚ç”±äºé€šè¿‡ Pjax åˆ‡æ¢çš„é¡µé¢å¹¶æ²¡æœ‰å®Œå…¨åˆ·æ–°ï¼Œæµè§ˆå™¨ä¸ä¼šå°†ç½‘é¡µä»å¤´æ‰§è¡Œä¸€éï¼Œå› æ­¤æœ‰äº› JS å°†ä¸ä¼šç”Ÿæ•ˆã€‚é‡è½½ JS è„šæœ¬å¤§è‡´åˆ†ä¸ºä¸‰ç§ï¼šä¸€ç§æ˜¯é‡è½½ JS å‡½æ•°ï¼Œä¸€ç§æ˜¯é‡è½½æ•´ä¸ª JS æ–‡ä»¶ï¼Œå¦ä¸€ç§æ˜¯é‡è½½å†…è”çš„ <code>script</code> æ ‡ç­¾ã€‚</p><ol><li>é‡è½½ JS å‡½æ•°</li></ol><p>è¿™ç§é‡è½½ä¸€èˆ¬é€‚ç”¨äºç”¨æˆ·è‡ªå·±ç¼–å†™çš„ä¸€äº› JS å‡½æ•°ã€‚ä½†æ˜¯å…·ä½“æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œå‡½æ•°è¦ä¸è¦é‡è½½è¿˜å¾—å…·ä½“åˆ†æã€‚ä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­ï¼š</p><ul><li>é¡µé¢ä¸å˜éƒ¨åˆ†å¯¹åº”çš„äº‹ä»¶</li></ul><p>æ¯”å¦‚ï¼Œé¡µé¢é¡¶éƒ¨æ æœ‰ä¸€ä¸ªæœç´¢æŒ‰é’®ï¼Œç‚¹å‡»ä¹‹åä¼šå¼¹å‡ºæœç´¢æ¡†ï¼š</p><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'.search-button'</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ç”±äºé¡µé¢é¡¶éƒ¨æ ä¸å˜ï¼Œæ‰€ä»¥å…¶ä¸­çš„å…ƒç´ ä¸Šç»‘å®šçš„äº‹ä»¶ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œè¿™éƒ¨åˆ†å…ƒç´ å¯¹åº”çš„ JS äº‹ä»¶ä¸éœ€è¦é‡è½½ã€‚</p><ul><li>é¡µé¢å¯å˜éƒ¨åˆ†å¯¹åº”çš„äº‹ä»¶</li></ul><p>æ¯”å¦‚ï¼Œé¡µé¢ä¸»ä½“éƒ¨åˆ†æ˜¯å˜åŒ–çš„ï¼Œæ‡’åŠ è½½å…¶ä¸­çš„å›¾ç‰‡ï¼š</p><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> imgs = <span class="built_in">document</span>.querySelectorAll(<span class="string">'#main img.lazyload'</span>);</span><br><span class="line"></span><br><span class="line">lazyload(imgs);</span><br></pre></td></tr></table></div></figure><p>å½“é€šè¿‡ Pjax åˆ‡æ¢é¡µé¢åï¼Œç”±äºä¸»ä½“éƒ¨åˆ†æ”¹å˜ï¼Œä¸Šè¿°ä»£ç å·²ç»å¤±æ•ˆï¼Œå› æ­¤éœ€è¦è¿›è¡Œé‡è½½ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°å°è£…ä¸€ä¸‹ï¼š</p><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pjax_reload</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> imgs = <span class="built_in">document</span>.querySelectorAll(<span class="string">'#main img.lazyload'</span>);</span><br><span class="line"></span><br><span class="line">  lazyload(imgs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pjax å®Œæˆåï¼Œé‡æ–°åŠ è½½ä¸Šé¢çš„å‡½æ•°</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'pjax:complete'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  pjax_reload();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure><ol start="2"><li>é‡è½½æ•´ä¸ª JS æ–‡ä»¶</li></ol><p>è¿™ç§æƒ…å†µå¤šæ•°ç”¨äºç¬¬ä¸‰æ–¹æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼Œåœç®—å­ç»Ÿè®¡çš„è„šæœ¬ã€è°·æ­Œ / ç™¾åº¦ / è…¾è®¯åˆ†æçš„è„šæœ¬ç­‰ï¼Œè¿™äº›è„šæœ¬åœ¨æ¯ä¸€æ¬¡é¡µé¢åŠ è½½åéƒ½éœ€è¦æ‰§è¡Œã€‚</p><p>æˆ‘çš„åšæ³•æ˜¯ï¼Œåœ¨å¼•å…¥è¿™äº›æ–‡ä»¶çš„æ ‡ç­¾ä¸Šæ·»åŠ  <code>data-pjax</code> å±æ€§ï¼Œç„¶åå°†å…·æœ‰è¿™ä¸ªå±æ€§çš„æ ‡ç­¾é‡æ–°æ·»åŠ åœ¨é¡µé¢ä¸­ã€‚æœ‰æ—¶å€™ä¸æ–¹ä¾¿åœ¨è¿™äº›æ ‡ç­¾ä¸Šæ·»åŠ é¢å¤–çš„å±æ€§ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨è¿™äº›æ ‡ç­¾å¤–å¥—ä¸€å±‚æ ‡ç­¾ï¼Œå¦‚ <code>&lt;div class=&quot;.pjax-reload&quot;&gt;&lt;/div&gt;</code>ï¼Œç„¶åå°† <code>.pjax-reload</code> é‡Œçš„å…ƒç´ å…¨éƒ¨é‡æ–°æ·»åŠ åˆ°é¡µé¢ä¸­å³å¯ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/sukkaw/busuanzi/bsz.pure.mini.js"</span> <span class="attr">data-pjax</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">".pjax-reload"</span>&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://www.google-analytics.com/analytics.js"</span>&gt;</span><span class="undefined"></span></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></div></figure><figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery å†™æ³•</span></span><br><span class="line">$(<span class="string">'script[data-pjax], .pjax-reload script'</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="keyword">this</span>).parent().append($(<span class="keyword">this</span>).remove());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// JS å†™æ³•</span></span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'script[data-pjax], .pjax-reload script'</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">elem</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> id = element.id || <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">var</span> src = element.src || <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">var</span> code = element.text || element.textContent || element.innerHTML || <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">var</span> parent = element.parentNode;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line"></span><br><span class="line">  parent.removeChild(element);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (id !==<span class="string">''</span>) &#123;</span><br><span class="line">    script.id = element.id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (src !== <span class="string">''</span>) &#123;</span><br><span class="line">    script.src = src;</span><br><span class="line">    script.async = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (code !== <span class="string">''</span>) &#123;</span><br><span class="line">    script.appendChild(<span class="built_in">document</span>.createTextNode(code));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  parent.appendChild(script);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure><p>çœ‹åˆ°ä¸¤ç§å†™æ³•çš„å·®è·ï¼Œæ„Ÿè§‰æ•´ä¸ªäººéƒ½ä¸å¥½äº†ã€‚</p><ol start="3"><li>é‡è½½æ•´ä¸ª <code>script</code> æ ‡ç­¾</li></ol><p>è¿™ç§æƒ…å†µå’Œå‰é¢ç±»ä¼¼ï¼Œå¦‚æœä¸€äº› JS è„šæœ¬å†™åœ¨ <code>script</code> æ ‡ç­¾ä¸­ï¼Œå¹¶ä¸”éœ€è¦é‡è½½ï¼Œå¯ä»¥é€‰æ‹©ç›´æ¥é‡è½½æ•´ä¸ª <code>script</code> æ ‡ç­¾ã€‚å…·ä½“åšæ³•å’Œä¸Šä¸€æ­¥ç›¸åŒï¼Œåœ¨æ ‡ç­¾ä¸Šæ·»åŠ  <code>data-pjax</code> å±æ€§ï¼Œç„¶åå°†å…·æœ‰è¿™ä¸ªå±æ€§çš„æ ‡ç­¾é‡æ–°æ·»åŠ åˆ°é¡µé¢ä¸­ã€‚</p><h2 id="æ€»ç»“"><span class="heading-link">æ€»ç»“</span></h2><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº† Pjax çš„åŸºæœ¬ç”¨æ³•ï¼Œå’Œä¸€äº›å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ³•ã€‚ä¸‹é¢ï¼Œèµ¶å¿«åŠ¨èµ·æ‰‹æ¥ï¼Œè®©ä½ çš„ç½‘ç«™ä½¿ç”¨ Pjax å§ã€‚</p><hr><p>å‚è€ƒé“¾æ¥ï¼š</p><ul><li><span class="external-link"><a href="https://www.zhihu.com/question/20289254" target="_blank" rel="noopener">pjax æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</a><i class="fa fa-external-link"></i></span></li><li><span class="external-link"><a href="https://paugram.com/coding/add-pjax-to-your-website.html" target="_blank" rel="noopener">è®©ä½ çš„ç½‘ç«™å®ç° PJAX æ— åˆ·æ–°</a><i class="fa fa-external-link"></i></span></li></ul></div><footer class="post-footer"><div class="post-end"><span>------ </span><span>æœ¬æ–‡ç»“æŸï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»</span><span> ------</span></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-author-name">æœ¬æ–‡ä½œè€…: </span><span class="post-copyright-author-value"><a href="https://liuyib.github.io">liuyib</a></span></div><div class="post-copyright-link"><span class="post-copyright-link-name">æœ¬æ–‡é“¾æ¥: </span><span class="post-copyright-link-value"><a href="https://liuyib.github.io/2019/09/24/use-pjax-to-your-site/">https://liuyib.github.io/2019/09/24/use-pjax-to-your-site/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-notice-name">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-notice-value">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</span></div></div><div class="post-tags"><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="https://liuyib.github.io/tags/Pjax/">Pjax</a></span><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="https://liuyib.github.io/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/">ç¬¬ä¸‰æ–¹åº“</a></span><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="https://liuyib.github.io/tags/%E5%B1%80%E9%83%A8%E5%88%B7%E6%96%B0/">å±€éƒ¨åˆ·æ–°</a></span></div><div class="reward"><div class="reward-button">è¯·æˆ‘å–æ¯å’–å•¡~</div><div class="reward-qr"><span class="reward-qr-alipay"><img class="reward-qr-alipay__img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190529222805.png"><div class="reward-qr-alipay-text">æ”¯ä»˜å®æ‰“èµ</div></span><span class="reward-qr-wechat"><img class="reward-qr-wechat__img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190529222806.png"><div class="reward-qr-wechat-text">å¾®ä¿¡æ‰“èµ</div></span></div></div><nav class="paginator"><div class="paginator-post"><div class="paginator-post-next"><a class="paginator-post-next__a" href="/2019/08/20/develop-hexo-theme-from-0-to-1/"><span>ä»0åˆ°1å¼€å‘Hexoä¸»é¢˜æ‚è°ˆ</span><i class="fa fa-chevron-right"></i></a></div></div></nav></footer></div></div><div class="comments" id="comments"><div id="gitalk-container"></div></div></div><aside class="sidebar" id="sidebar"><div class="sidebar-inner"><div class="sidebar-nav"><span class="sidebar-nav-toc current">æ–‡ç« ç›®å½•</span><span class="sidebar-nav-ov">ç«™ç‚¹æ¦‚è§ˆ</span></div><section class="sidebar-toc"><div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pjax-åŸç†"><span class="toc-number">2.</span> <span class="toc-text">Pjax åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¼€å§‹ä½¿ç”¨"><span class="toc-number">3.</span> <span class="toc-text">å¼€å§‹ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¼•ç”¨æ–‡ä»¶"><span class="toc-number">3.1.</span> <span class="toc-text">å¼•ç”¨æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ†æé¡µé¢"><span class="toc-number">3.2.</span> <span class="toc-text">åˆ†æé¡µé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ·»åŠ è¿›åº¦æ¡"><span class="toc-number">3.3.</span> <span class="toc-text">æ·»åŠ è¿›åº¦æ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é‡è½½-js-è„šæœ¬"><span class="toc-number">3.4.</span> <span class="toc-text">é‡è½½ JS è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">4.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></section><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190528162910.jpg" alt="avatar"></div><p class="sidebar-ov-author__p">write code and love life</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social__item" href="https://github.com/liuyib/" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><i class="sidebar-ov-social__item--icon fa fa-github"></i></a><a class="sidebar-ov-social__item" href="https://segmentfault.com/u/liuyib/" target="_blank" rel="noopener" data-popover="æ€å¦" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">sf</span></a><a class="sidebar-ov-social__item" href="https://www.zhihu.com/people/liu-yibo-64-65/activities/" target="_blank" rel="noopener" data-popover="çŸ¥ä¹" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">çŸ¥</span></a><a class="sidebar-ov-social__item" href="https://juejin.im/user/5ad6b350f265da2397076275/" target="_blank" rel="noopener" data-popover="æ˜é‡‘" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">æ˜</span></a></div><div class="sidebar-ov-feed"><span class="sidebar-ov-feed-email"><a class="sidebar-ov-feed-email__a" href="http://eepurl.com/guAE6j" target="_blank" rel="noopener"><i class="sidebar-ov-feed-email__a--icon fa fa-envelope"></i><span>Email </span><span>è®¢é˜…</span></a></span><span class="sidebar-ov-feed-rss"><a class="sidebar-ov-feed-rss__a" href="/atom.xml" target="_blank" rel="noopener"><i class="sidebar-ov-feed-rss__a--icon fa fa-rss"></i><span>RSS </span><span>è®¢é˜…</span></a></span></div><div class="sidebar-ov-state"></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" data-popover="çŸ¥è¯†å…±äº«" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg" alt="çŸ¥è¯†å…±äº«"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span>ä½ å·²é˜…è¯»äº† </span><span class="sidebar-reading-info-num">0</span></div><div class="sidebar-reading-line"></div></div></div></aside><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright &copy; 2019</span><span class="fa fa-heart footer-icon"></span><span>liuyib. All Rights Reserved.</span></div><div><span>ç”± <a href="http://hexo.io/" title="hexo" target="_blank" rel="noopener">hexo</a> å¼ºåŠ›é©±åŠ¨</span><span> v4.0.0.</span><span class="separator">|</span><span>ä¸»é¢˜ - <a href="https://github.com/liuyib/hexo-theme-stun/" title="stun" target="_blank" rel="noopener">stun</a></span><span> v1.5.4.</span></div><div class="busuanzi"><span class="busuanzi-site-uv"><i class="fa fa-user busuanzi-site-uv__icon"></i><span>è®¿é—®äººæ•° </span><span id="busuanzi_value_site_uv"></span></span><span class="separator">|</span><span class="busuanzi-site-pv"><i class="fa fa-eye busuanzi-site-pv__icon"></i><span>æµè§ˆæ€»é‡ </span><span id="busuanzi_value_site_pv"></span></span><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><div><span>æ‰˜ç®¡äº <a href="https://pages.github.com/" rel="noopener" target="_blank">Github Pages</a></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="progress"></div></div><div class="back2top" id="back2top"><i class="back2top-icon fa fa-rocket"></i></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="æœç´¢æ–‡ç« ï¼ˆæ”¯æŒå¤šå…³é”®è¯ï¼Œè¯·ç”¨ç©ºæ ¼åˆ†éš”ï¼‰"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/ribbon.js@latest/dist/ribbon.min.js" size="120" alpha="0.6" zindex="-1"></script><script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js"></script><script>window.addEventListener("DOMContentLoaded",function(){$(".header-nav-search").on("click",function(t){t.stopPropagation(),$("body").css("overflow","hidden"),$(".search-popup").addClass("show").velocity("stop").velocity("transition.expandIn",{duration:300,complete:function(){$(".search-popup input").focus()}}),$(".search-mask").velocity("stop").velocity("transition.fadeIn",{duration:300}),$.ajax({url:e,dataType:r?"xml":"json",async:!0,success:function(t){var n=r?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,o=$(".search-input input"),i=$(".search-results"),m={title:100,content:1},e=function(){var t=o.val().toLowerCase().trim(),x=t.split(/[\s]+/),$=[];1<x.length&&x.push(t),0<t.length&&n.forEach(function(t){var e=!1,n=t.title&&t.title.trim()||"[ æ–‡ç« æ— æ ‡é¢˜ ]",o=n&&n.toLowerCase(),i=t.content&&t.content.replace(/<[^>]+>/g,""),r=i&&i.toLowerCase(),c=t.url&&decodeURI(t.url).replace(/\/{2,}/g,"/"),a=[],s=[];x.forEach(function(t){function e(e,t,n,o){if(!e||!t)return[];var i=0,r=-1,c=[];for(n||(e=e.toLowerCase(),t=t.toLowerCase());-1!==(r=t.indexOf(e,i));){var s=!1;a.forEach(function(t){t.index===r&&t.word.length<e.length&&(t.word=e,s=!0)}),i=r+e.length,!s&&c.push({index:r,word:e,weight:o})}return c}a=a.concat(e(t,o,!1,m.title)),s=s.concat(e(t,r,!1,m.content))});var l=a.length,u=s.length;if((0<l||0<u)&&(e=!0),e){function h(n,t,e,o){if(n&&t&&t.length){var i="",r=e,c=o;return t.forEach(function(t){if(!(t.index<r)){var e=t.index+t.word.length;i+=n.slice(r,t.index),i+="<b>"+n.slice(t.index,e)+"</b>",r=e}}),i+=n.slice(r,c)}}[a,s].forEach(function(t){t.sort(function(t,e){return t.index-e.index})});var d,f={},p=a.length*m.title+s.length*m.content,v=h(n,a,0,n.length)||n;if(0<s.length){var g=s[0].index,w=20<g?g-20:0,y=g+180;d=h(i,s,w,y)}else d=i.slice(0,200);f.title=v,f.content=d,f.url=c,f.weight=p,$.push(f)}});var e="";$.length?($.sort(function(t,e){return e.weight-t.weight}),e+="<ul>",$.forEach(function(t){e+='<li><a class="search-results-title" href="'+t.url+'">',e+=t.title,e+='</a><div class="search-results-content">',e+=t.content,e+="</div></li>"}),e+="</ul>"):e+='<div class="search-results-none"><i class="fa fa-meh-o"></i></div>',i.html(e)};o.on("input",e),o.on("keypress",function(t){t.keyCode===Stun.utils.codeToKeyCode("Enter")&&e()})}})}),$(".search-mask, .search-close").on("click",function(){n()}),$(document).on("keydown",function(t){t.keyCode===Stun.utils.codeToKeyCode("Escape")&&n()});var r=!0,t="search.json";t?/json$/i.test(t)&&(r=!1):t="search.xml";var e="/"+t;function n(){$("body").css("overflow","auto"),$(".search-popup").removeClass("show").velocity("stop").velocity("transition.expandOut",{duration:300}),$(".search-mask").velocity("stop").velocity("transition.fadeOut",{duration:300})}},!1)</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",function(){new Pjax({selectors:["head title","#main",".pjax-reload",".header-info"],history:!0,scrollTo:!1,scrollRestoration:!1,cacheBust:!1,debug:!1,currentUrlFullReload:!1,timeout:0});var a=null;document.addEventListener("pjax:send",function(){$(".header-nav-menu").removeClass("show"),CONFIG.pjax&&CONFIG.pjax.scrollTo2screen&&$("html").velocity("scroll",{duration:500,offset:$("#header").height(),easing:"easeInOutCubic"});var e=20;$(".loading-bar").addClass("loading"),$(".loading-bar .progress").css("width",e+"%"),clearInterval(a),a=setInterval(function(){95<(e+=3)&&(e=95),$(".loading-bar .progress").css("width",e+"%")},500)},!1),window.addEventListener("pjax:complete",function(){clearInterval(a),$(".loading-bar .progress").css("width","100%"),$(".loading-bar").removeClass("loading"),setTimeout(function(){$(".loading-bar .progress").css("width","0")},400),$("link[rel=prefetch], script[data-pjax-rm]").each(function(){$(this).remove()}),$("script[data-pjax], #pjax-reload script").each(function(){$(this).parent().append($(this).remove())}),Stun.utils.pjaxReloadBoot&&Stun.utils.pjaxReloadBoot(),Stun.utils.pjaxReloadScroll&&Stun.utils.pjaxReloadScroll(),Stun.utils.pjaxReloadHeader&&Stun.utils.pjaxReloadHeader(),Stun.utils.pjaxReloadSidebar&&Stun.utils.pjaxReloadSidebar()},!1)},!1)</script><div id="pjax-reload"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@1.0.1/dist/quicklink.umd.js"></script><script>function initQuicklink() {
  quicklink({
    timeout: '10000',
    priority: 'true',
    ignores: [uri => uri.includes('#'), uri => uri === 'https://liuyib.github.io/2019/09/24/use-pjax-to-your-site/', /\/api\/?/,uri => uri.includes('.xml'),uri => uri.includes('.zip'),(uri, el) => el.hasAttribute('nofollow'),(uri, el) => el.hasAttribute('noprefetch')]
  });
}

if (true || false) {
  initQuicklink();
} else {
  window.addEventListener('DOMContentLoaded', initQuicklink, false);
}</script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js" data-pjax=""></script><script src="https://cdn.jsdelivr.net/npm/js-md5@latest/src/md5.min.js" data-pjax=""></script><script data-pjax="">function loadGitalk(){document.getElementById("gitalk-container")&&new Gitalk({id:md5(window.location.pathname.slice(1)),clientID:"f9773b8f4bf0eab8bdf7",clientSecret:"b8cf368c44428ae4d7c9d0ec634532219e8cdf67",repo:"liuyib.github.io",owner:"liuyib",admin:["liuyib"],distractionFreeMode:"true",language:"zh-CN"}).render("gitalk-container")}loadGitalk()</script><script src="/js/utils.js?v=1.5.4"></script><script src="/js/stun-boot.js?v=1.5.4"></script><script src="/js/scroll.js?v=1.5.4"></script><script src="/js/header.js?v=1.5.4"></script><script src="/js/sidebar.js?v=1.5.4"></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js?t=1577684966720").then(function(){console.log("ServiceWorker Register Successfully.")}).catch(function(e){console.error(e)})</script></body></html>